pipeline {
 agent any {
   stages {
    node {
     def app{
       stage ('Clone repository') {
         checkout scm
       }
    
       stage ('Build Image') {
        app = docker.build("dockerhublink")
       }
    
       stage ('Test Image') {
        app.inside {
         echo " Tests Passed "
        }
       }
    
       stage ('Push Image') {
        docker.withRegistry('Docker Link','Docker ID in Jenkins while adding the credentials')  
          app.push("${env.BUILD_number}")
          app.push('latest')
          }
             echo "Build Uploading :)"
       }
      }
